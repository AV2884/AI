import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
x_train_us = np.array([2185.430534813131, 4778.214378844623, 3793.972738151323, 3193.9631788866645, 1202.0838819909643, 1201.9753415129119, 761.3762547568977, 4397.7926559872085, 3205.0175528444397, 3686.3266000822045, 592.630224331111, 4864.594334728975, 4245.991883601898, 1455.5259980522428, 1318.2123524319527, 1325.3202943404522, 1869.0900933179198, 2861.4039423450704, 2443.752583889521, 1810.5311308911887, 3253.3380262507076, 1127.7223729341881, 1814.6509184084816, 2148.6282948216126, 2552.3149289766616, 4033.291826268561, 1398.5320197126189, 2814.0549728612523, 3165.865559879191, 709.0268572399898, 3233.9518335564726, 1267.358556592812, 792.7321684337578, 4769.984917639999, 4845.344148835517, 4137.7880665240755, 1870.7619612801682, 939.5245130287274, 3579.048619304706, 2480.686221828206, 1049.1720568015048, 2728.2960955007156, 654.7483450184827, 4591.941809354519, 1664.5099172000762, 3481.350279592919, 1902.6998424023493, 2840.3060953001486, 2960.1962570447586, 1331.8450498648717, 4863.130824940514, 3988.0977051250156, 4727.745237038851, 4526.72307692442, 3190.549904649883, 4648.434057604026, 898.2162592336377, 1381.9228808861535, 703.5228000974213, 1963.9864884346896, 2249.047803602669, 1721.0706429825316, 4229.318791183682, 2105.3899701211517, 1764.2052935932134, 2942.132374212118, 1134.1590123864319, 4109.886413393178, 835.4778965589687, 4940.991214702328, 3975.101461834958, 1394.2205669037758, 524.8495270562108, 4169.576428046754, 3680.858047314277, 3780.5322561844428, 3970.7165600867556, 833.2009328034067, 2113.0957784492266, 1021.4107678630837, 4383.965416440171, 3304.8415707240106, 1989.0411118369213, 786.0125762871064, 1899.4204477204798, 1963.3249491203617, 3783.227802521288, 3369.008621098459, 4492.457341593469, 2624.967163228772, 1038.1741067223577, 3709.6015425034775, 3923.5327187760386, 3025.747389062733, 3969.3523097955244, 2722.080183639758, 2852.297732218973, 2423.934582613473, 614.3860703484283, 985.51142146987, 641.4313355903041, 3363.8468506870117, 1914.60191484347, 2788.5681102411627, 4584.049132667418, 1621.8150311699374, 2346.723153660334, 3899.980123443719, 1529.591744712301, 846.4095942295685, 1803.8815381119562, 1225.4957926430197, 4683.639435541579, 4136.5417080398765, 3350.3169042969057, 4421.5726558447295, 4116.524346046015, 1339.5652649871613, 4516.5154932049, 2927.0400886204284, 4133.480698238282, 4532.41084965572, 1931.0156373733873, 995.2336603745455, 1525.7082314387376, 2421.9850488181537, 4181.066446651219, 4373.287624653545, 531.2845873903582, 2798.3628615990456, 2378.3495141695057, 1499.485147118286, 1039.3941530015727, 2019.2682713163258, 4743.093667606337, 1954.4131940933985, 2834.5577978451474, 3663.5853150283, 2136.3332107068227, 4873.019372244323, 4831.0128272395, 1633.0203312141387, 2737.6182765157346, 1853.9523941754635, 1781.7822246986043, 665.9912630953976, 3243.0395029095357, 2762.0556045298767, 731.6543806249521, 1753.9090890647515, 4587.196486849942, 1578.028508001376, 1152.0269244105039, 2702.5374212490337, 4935.427043497703, 1589.2487218017518, 3524.6099633264535, 3927.288268979229, 1569.3689479657985, 3776.973568753368, 2155.0240972366396, 3345.3762376711074, 3350.883698424026, 2910.9860783364134, 906.3039652448374, 4258.861230151571, 1943.5102923728114, 1339.333296799344, 683.4881369964376, 3159.018244347088, 3549.0396282902707, 574.6452301753527, 2804.418762346764, 1519.2309883907208, 3403.2775568425245, 1284.6489305224613, 3609.2198214610967, 2240.309058352418, 4715.284949315305, 1118.8442486569697, 2034.7985797261633, 1010.6308455826509, 4661.121282253533, 4448.027090214415, 1660.7373247182002, 3469.9282071538055, 4177.499900905472, 2998.4036521975804, 2883.4276026020293, 1588.3353090520325, 918.9624551265465, 4537.470910789971, 4551.881257234987, 3348.9565577297058, 2025.6340597191531, 2071.443085756974, 3766.800554916077, 4536.9961697865965, 4491.888909193028, 4009.4399563593074, 3389.142407694295, 878.6298424777198, 1227.329213425762, 4543.493848371856, 3228.930768468155, 541.3867322748334, 956.6219428971444, 3485.757960986251, 522.7771273079841, 1223.636231378744, 2969.3020521496373, 3613.5283896171195, 3433.8256677617023, 1509.211892572519, 3704.8064960639113, 1567.6208937356002, 1964.2986417167047, 3859.211323031109, 3423.348045712466, 4321.5053472238005, 3459.258015351545, 3057.3887150096225, 921.5364552264161, 2154.721113767451, 1693.4106545677646, 1597.9533952058762, 4878.547496386005, 2268.9397610004216, 4514.20949829701, 3340.123816987683, 4076.650865937418, 2761.8669189733646, 3096.067480818616, 2716.3296221848877, 1378.5934450912002, 3751.034518676774, 1763.475630983851, 609.4218489415423, 3404.625331582255, 1296.9980573317202, 4732.063629588114, 4792.678596511643, 4616.889755992019, 2165.7141511494997, 569.5547743799034, 4677.433531644764, 2426.8286674279143, 4849.946685696513, 4836.289896901638, 4338.54254960312, 1825.0200143131356, 2232.9397787086637, 4330.115021825856, 1926.1490232032495, 1262.7173600874162, 3005.6056810625755, 4712.696483723515, 3632.1340850373786, 3065.2752654021424, 937.2942219684585, 3267.532520146264, 4955.242325469185, 1130.3780685643583, 2832.483435636815, 4448.178823675799, 3833.45877989392, 3636.570834478706, 3661.1783779419916, 2117.710180488898, 1821.1632991902202, 4142.125199653312, 4145.510276056313, 4401.8254336104665, 4609.58248650412, 2801.04079487422, 2756.823326092398, 4092.3283053504883, 3424.8376884999434, 3658.850947659665, 4081.067012462455, 4505.024038179048, 2020.978205831911, 2190.123286879748, 922.9187292839106, 3102.2606344827827, 661.7402320853394, 2595.1910815960705, 2941.9008561840947, 1789.4356345772799, 3158.7496725605483, 637.2511247257224, 668.0668493714649, 4201.702522968462, 2120.8578863506827, 1071.7723069334816, 2850.0946702466194, 3964.9709889437486, 1471.1946237357943, 3303.007141185501, 884.063592471956, 732.5677452587347, 2891.095842056666, 2932.858047245479, 3368.4345567419296, 3767.411001751977, 4891.334357581406, 2823.351567355379, 1953.3041282356069, 4078.3378764591666, 1718.745130679334, 2475.3713931753628, 853.0537160401968, 614.0783453695587, 4831.917866050663, 4261.910542304926, 3631.8839274216407, 2340.288249864215, 1279.824440318806, 1203.9666920198872, 1626.093041740679, 2971.519991177542, 3715.6816521502806, 3470.8881952297907, 1759.7025362567429, 4796.893762984373, 3820.536125130958, 2994.593236301303, 3252.7433580545853, 2388.2002809250544, 1614.7894527552087, 2101.877053930677, 3910.307497089661, 564.7706988339014, 1022.3268822811231, 707.0118890978874, 683.2796104353656, 4349.572628049533, 3666.4603672101066, 2633.7822308929635, 940.2537229295067, 2712.2714380257457, 2630.6229685125454, 1279.4084145950683, 2452.332421570879, 2293.2713047881807, 3271.3254412349743, 3357.921428904397, 703.8680439742003, 2185.7567658191206, 3316.369620714064, 2764.1131636103946, 4354.20428534745, 3464.1213422852525, 1233.2049218664336, 817.5593633019344, 3390.8867519284204, 619.3008974372982, 3135.990115730585, 4731.0360864123095, 3089.633800441455, 2246.7646679293484, 3394.796982990589, 2562.138007211825, 2955.275551921707, 4736.591639494363, 2237.461870103484, 4825.357537207614, 4574.077888802287, 1381.060106551834, 812.1258539382445, 953.5010061984199, 581.9982154319738, 924.9933234016778, 3573.5304803736058, 820.3489180710304, 1935.3903363219258, 4301.938899362545, 604.7237108112164, 4165.10817165021, 1768.3464864802997, 1031.7417242974532, 3635.317244138678, 3330.2428105094777, 4448.624060871738, 3807.819697117486, 4115.6641867318185, 1769.1555765708792, 1298.4779470087528, 3877.7663823838625, 4130.756326702688, 4957.273139003029, 2356.7795461014193, 2174.0813860675244, 3993.858323338986, 2033.6159311385802, 4688.407965216042, 4362.857383293553, 2430.4731231875826, 3878.9198050617383, 3895.4429333810704, 964.0574097616968, 4561.48808005805, 2773.635676015357, 4219.058597484837, 1940.2232046377528, 4529.854528232902, 2251.4075543037343, 548.7694316613427, 4574.218893886687, 910.790045537601, 1936.9113691568668, 4775.278851728622, 4777.732161219003, 3080.4704965547876, 3343.267454764097, 2518.004848902439, 1819.4484726412904, 1978.9904541646217, 3526.333052346673, 3885.68538246956, 4062.1056967663185, 4053.2816425754927, 910.4274637191066, 2724.8913711616165, 759.0144200748992, 2972.87997045681, 2486.8872561801963, 4494.668822412349, 2079.1175564843543, 1026.8015739242264, 1143.4625692377613, 3926.7978427286253, 3281.981284923175, 955.052042552556, 878.4806275174885, 3654.36109156604, 827.4335286388709, 4198.3702668066035, 3678.090022204233, 866.069512888549, 881.7697133833636, 4939.87810325529, 2184.2185809025414, 2167.8896618010094, 4157.598052658761, 4762.618598227365, 4937.004787202919, 3890.2018336652372, 2193.1681348891207, 875.7532251440094, 3997.1611216734655, 3012.8191238111226, 2408.9990416113933, 4578.594732926312, 1000.388670377681, 2716.8129693088663, 551.0914014533859, 2608.9728889735684, 753.3647405682681, 1034.6806232063236, 1028.868110496972, 3421.446359522286, 3857.201956694405, 3125.1594429372185, 4829.776468135438, 2186.9176078566684, 1785.7043882683734, 4408.696076852571, 1506.1812733375368, 4834.501427482751, 554.6951361041736, 4864.454720184375, 694.2196037775925, 4510.14401164132, 2874.6549908883494, 4968.341582536851, 832.0845413092949, 2992.3442798059436, 4861.861410285946, 2853.9402987656695, 3332.2938716086815, 3630.869100430777, 2545.43479145498, 3324.0113603782856, 3129.414403653951, 4555.21104720945, 704.5087115365604, 1764.3343531650364, 4776.851678344514, 4506.187027509123, 2550.4553875357083, 3290.5966901069155, 1748.2153234150971, 1346.5452187569258, 2586.6428222299196, 2090.0850261172377, 3126.452503328924, 849.8058663424317, 4884.776634497749, 4937.948350158213, 3641.7277130888533, 2912.433648548542, 1892.8742732884748, 4162.077588681269, 3581.2902764924565, 1231.7762270520109, 4599.172330222291, 4201.41759315426, 4774.099609813658, 3765.7377877476197, 3260.3683817110546, 2382.093663307785, 4697.27817509306, 4397.287502751838, 703.4840154778524, 618.651385237634, 2194.085150951223, 4147.489988518248, 4942.74258191725, 1176.8760099658768, 3173.588219084608, 2214.008854839597, 4864.614790165714, 4289.535154110689, 4272.479171200121, 2609.1192190773663, 2366.687760519493, 1730.331823688178, 753.689734929172, 4391.25069314774, 4158.054541085349, 4998.729529787588, 4984.865766832574, 2999.4426752118234, 3960.4433683122975, 4751.445784470926, 4323.413258048351, 1613.0664578443896, 2527.448608895421, 1081.2173681817276, 4793.229622664251, 3227.78585502896, 1528.8926247655822, 3522.653079826355, 3281.577082060531, 2111.732231147782, 1011.0091648983306, 3522.079380167598, 2841.3846540670697, 3975.432762810377, 2840.73575500397, 4334.816751433431, 2983.580774485185, 3024.220871909238, 4444.941211962552, 2315.6728979557865, 1103.0685280278833, 629.5220434100254, 3898.1176505312856, 3291.392981090591, 3668.358956446506, 1458.3387267900985, 1113.671640140464, 565.4509955054687, 2077.6440146296864, 3154.6295908458487, 2265.0982029487955, 2468.6371491067807, 4568.714125221868, 2067.1496016048513, 2812.9527012191484, 4026.4385573351437, 2284.4425204457157, 3299.390151025431, 4380.636689360354, 4772.842806459389, 1161.8306641806707, 4669.644313226725, 2714.523318857922, 1662.0997473453126, 2566.110903072176, 4910.146588784647, 2716.7814229679134, 1979.382246293787, 3350.303844425266, 1580.655284501869, 841.3849764889876, 1079.9587485979214, 1076.206275309976, 1183.5621208053244, 1124.7222769223456, 3383.936351614466, 1318.4603797961518, 2055.5027749573846, 4535.547844577053, 2632.8273811829254, 3504.0098233446224, 1275.4394204073342, 1365.3005846390183, 683.9087731991549, 1260.2077838247405, 1753.656525643814, 1296.5471792453607, 899.1614019067503, 1042.8614199527037, 2573.504456147266, 1428.5017328260662, 2139.2143747163395, 2765.377718846856, 3606.776728832144, 676.9046292849453, 4097.3467950906925, 3325.551752709085, 867.9156437699236, 4431.103808480498, 4643.92580239316, 774.8508193468869, 1745.9494166624168, 4127.905759068776, 3867.1686067264627, 1330.344587103698, 1442.0719550151964, 2167.124462561219, 2680.353433359596, 3282.1464718863317, 2160.111378063976, 2581.4062225991656, 3863.6192216019044, 665.0744130076905, 1635.9662495480934, 3710.073136480486, 4528.430769592397, 2802.5484895204977, 2894.5106836939203, 982.2740510289923, 2513.355650705546, 2896.777699047604, 1591.1172663562834, 1711.5945392722144, 2197.778733970802, 590.3203899997686, 1949.3562451243022, 1451.5160314844509, 1973.738084800616, 1038.9295931866304, 4507.3727633295275, 3171.1660409932188, 3555.9604361502033, 4051.2705737330225, 2742.9898951807577, 891.1412963934066, 2916.979438183465, 3140.785031093956, 3854.477633829485, 2442.4679580335574, 1074.111362580037, 1776.9915760942602, 2133.8703337938578, 3406.6275859922057, 3068.5023710101036, 2102.435266540308, 4939.318619568408, 3225.986687105992, 1567.5205628119752, 958.0211267918169, 1187.8661263294941, 1606.8097777302867, 1223.0661796680006, 1339.551608230876, 1782.928259122312, 1280.1811788263967, 4535.444410818913, 861.05185547739, 2860.301253066146, 2346.785721453477, 4920.703776088729, 1004.1750597562356, 2290.3501957058375, 4862.61694973916, 4394.782066522911, 4176.82431927176, 1660.5627217022293, 1268.9941432552962, 3508.8944896599396, 4682.191951074136, 3005.433018562684, 3072.2571026145492, 1759.9059214712788, 3962.718199363716, 1341.696868508855, 1956.5565638190965, 2414.4639737738753, 2784.2467040800475, 1590.843795867861, 1016.765711326416, 3247.7901909873467, 1798.837489581151, 3115.5719964017553, 1194.6322187339103, 2665.1304583466786, 2896.6524464821364, 733.2059157009211, 2014.7192518726426, 1104.8660462253843, 785.1873671274549, 4954.821045754754, 1950.5923023862533, 4144.435006345857, 1645.8829464369373, 3566.762250007682, 3921.0253695035894, 3180.374332735299, 2622.092848475713, 2353.2841136627085, 2069.907199443479, 4682.881149115216, 4237.787335044781, 4842.621097999307, 1059.3375056849513, 3788.903638416399, 4722.53205569467, 1315.5487977454707, 799.2332031504988, 3835.042921805266, 3085.1290093096036, 4288.229495412224, 1128.9756948183026, 4078.7029033695057, 1407.3229402148504, 1236.4517428956701, 1239.1960906894683, 4165.586241041219, 3493.3874931329005, 2853.794411461037, 2114.737178555761, 4447.402433658987, 2266.002983401859, 4174.697477622097, 2476.107088565983, 2196.249932412084, 2582.059035513229, 1856.2004337386393, 3864.24221079313, 2762.241755416156, 1544.957128160678, 4548.085579735558, 2227.5104961794514, 2945.9878750129487, 4579.124499340462, 3309.0709816129643, 1026.0411831876384, 4729.244556260638, 3324.6862388213804, 2007.0752659568875, 1126.7243269852427, 4073.113351716332, 3290.3274016783107, 2900.574913893447, 4522.516623729309, 4048.6874505103883, 1182.5369587973803, 1902.7493050799671, 1618.2011291650958, 3847.7583165770466, 650.8959563110072, 3064.5035819209243, 3931.0640858331076, 4445.445365427873, 2039.3678692215835, 4195.657871024057, 997.8428162984326, 4309.035312805332, 1073.6989804939208, 2287.792807521653, 4087.8291460079913, 1174.6284230694819, 1531.6312785468867, 3750.1365577687984, 3740.1644144573347, 3385.164347983838, 3622.7680001019503, 2942.259995064183, 1633.0957650812875, 2055.6319707676375, 1317.1897256064155, 4588.027526001328, 3125.263076447542, 2303.8313754363794, 2579.026116398597, 4762.775028253169, 1190.0813140223609, 3138.0342440755876, 2776.499054980097, 3251.5440594559154, 581.4958271937822, 4424.557590248682, 4694.532271176256, 3043.0993261514404, 3634.9287074460153, 4651.247215297831, 3682.5738544102937, 1186.425693114176, 3093.2976207506595, 3230.2177087228515, 2408.588020860737, 3813.999060311253, 4704.651566460567, 4665.058308080494, 2528.777171318595, 1009.5712062833986, 4931.785395330506, 4275.041389006703, 1060.9820654147009, 4643.788471778175, 4414.533629279577, 2834.7712570673243, 3160.7394608521818, 2295.512167415586, 746.427374699141, 2008.387587406554, 4112.840518691051, 520.8441035207129, 2000.7462726101487, 2291.759121159245, 2918.280213220653, 4639.3502738574225, 2058.5569746468254, 2061.2894085330245, 3818.755616493868, 2534.9807340041325, 1510.7217032299188, 2535.9778225971204, 1133.8565917090993, 1293.741439278005, 2742.654977327659, 2385.1645227704657, 4616.806554806451, 2130.772546024849, 3112.6475762511955, 3345.1892956378865, 558.9250546475014, 3485.918174075198, 1301.1618509138814, 4824.816428612548, 1168.9822748890083, 2365.808556771607, 884.0735063538973, 4985.934133306763, 2759.8775464905916, 3179.232577940197, 801.8441482479236, 3874.8221167963, 1444.575168930136, 4541.244302483212, 1423.1283821690322, 1358.0947429864996, 664.473505316427, 2624.3012529949965, 3041.7850996817738, 795.6888774275856, 3989.8742751275477, 2539.7997563661243, 2859.75621197411, 2483.432361222027, 2303.4337739389666, 3018.3814908869804, 1198.5811066882063, 1318.67658722872, 4378.035294560828, 4757.519579601348, 2179.8919232588883, 1718.351029145992, 3397.9979445755707, 2339.3037699414335, 614.2386004715519, 1202.6866881478568, 3721.875029813289, 3465.157738595681, 621.9319662656757, 1498.8747286982725, 1539.8365846463212, 3523.5173461942777, 588.6974198946386, 968.4886189305823, 4099.622384179353, 1303.4509792445012, 3437.357485333436, 1571.8225147102694, 947.4862674170532, 1594.2748594975433, 3750.2011933504664, 4350.634106478286, 4235.989390551462, 2287.325883283047, 3506.383114567908, 1422.4293293711944, 1819.1647861745596, 4533.511183345039, 558.5086557983121, 884.7883888451063, 1435.4881481571229, 619.3949174321888, 1316.459457904088, 3123.687024363615, 2396.4104776662407, 4517.022699846387, 4178.496027822985, 2038.178082640442, 1667.4054504408161, 2208.6158367527014, 3156.3272413166346, 1706.286383702943, 3308.670085321103, 2342.352434860582, 2984.212313833911, 2462.569381108925, 1825.0959179386296, 4768.039881329705, 3936.2260737189235, 1130.5092909490363, 4408.105891540607, 2693.4403921228113, 4525.485021023411, 4099.348651762919, 2413.4607701115506, 601.1118874405283, 1709.0481172322573, 2937.3539659739013, 3350.6519892176625, 1660.4945844494102, 1127.1023333277085, 4257.186065596847, 4929.809813165984, 2865.6058203620864, 1272.5567863173658, 1725.3829693371604, 582.7580444636003, 4614.344629522246, 1029.879873005635, 3094.324139814141, 1733.248493092427, 2993.8010113210703, 3431.391747583389, 4233.838116682407, 1428.8957229227144, 549.4812289631622, 1115.9853353096328, 4550.083888316472, 4432.5053490313185, 3188.358959766387, 3202.32587195144, 3492.6650354581498, 1289.1707538055232, 4614.853756662319, 2384.467362014329, 2224.1233771227385, 2835.129673772769, 711.3468504877477, 1248.2751594023573, 3821.151273918667, 872.5940056630691, 3214.184492598747, 1604.0709935659443, 2251.8302631888946, 1799.1218154681494, 2100.5272240922714, 3735.7065733291047, 1837.0477203042876, 3048.8208813360375, 2642.2268098959485, 3486.5202441319166, 4715.733826961411, 3796.5744374461265, 1467.2317036584054, 640.324107775781, 1680.188199349213, 3177.8506881511466, 731.4161606791265, 2733.6481124055636, 3185.7928201260015, 2004.0975086763237, 3969.1049168561985, 979.6921391019731, 838.1200178111394, 3776.8494029162152, 2729.710922927893, 3597.8107839248123, 2456.723023716858, 1608.8091495759807, 4185.960429533899, 4097.371455360407, 3626.1341188449205, 1724.653117534832, 3156.038000910892, 2124.3825362301204, 912.1193299698537, 4627.911089580092, 1115.6838391353263, 4776.068092193611, 2507.025978310801])
y_train_us = np.array([336699.63, 649964.94, 588105.8, 509623.76, 208302.1, 234335.34, 155902.55, 682627.9, 477244.35, 469900.94, 110375.44, 740073.53, 650477.72, 154491.47, 143679.03, 251455.69, 278385.76, 463285.63, 367978.81, 273067.48, 534914.89, 143356.12, 277003.68, 299180.48, 361122.43, 589535.17, 220886.49, 398170.81, 537667.64, 61623.66, 475749.19, 168117.23, 191258.72, 725325.48, 778393.85, 546390.19, 293966.81, 185410.22, 540971.49, 425376.95, 131511.39, 479711.79, 213157.16, 670649.34, 227401.36, 594871.77, 364383.58, 399902.91, 423020.1, 185687.53, 662247.1, 552282.06, 658954.75, 640618.58, 476848.24, 708975.85, 212257.46, 157370.73, 154744.54, 283898.53, 334883.99, 291901.57, 578261.72, 334928.98, 272953.4, 465942.42, 184582.28, 739247.97, 93434.69, 714598.83, 565108.19, 181359.23, 46858.07, 684887.29, 623153.92, 538542.52, 553989.71, 148550.92, 289353.21, 184858.21, 667740.96, 419939.03, 375731.43, 207695.77, 254273.63, 275113.66, 581777.44, 522074.13, 706795.81, 494255.3, 146878.75, 516525.37, 519563.95, 417315.61, 593746.5, 498039.92, 401964.09, 374779.58, 91336.77, 207246.38, 222561.32, 478033.59, 262718.32, 470493.26, 721701.94, 335607.62, 381204.88, 567032.41, 258971.5, 182396.62, 311606.34, 209188.07, 755879.65, 678946.04, 571655.49, 695671.39, 609122.75, 208270.47, 737802.77, 398209.23, 638455.77, 660194.69, 291089.59, 213207.64, 238411.19, 365619.58, 559167.16, 693305.82, 111966.9, 527917.17, 341363.52, 235880.29, 168378.31, 381762.9, 706699.27, 307113.06, 455578.5, 558868.25, 298128.3, 740657.41, 778333.51, 193627.28, 417291.23, 243086.82, 327019.67, 23739.34, 458509.83, 433168.93, 188024.36, 259798.85, 660319.5, 330762.13, 100403.34, 295440.32, 762314.78, 213284.6, 477629.85, 624511.06, 247595.38, 538342.1, 259238.39, 545429.3, 535142.61, 431689.12, 228277.44, 585324.95, 215250.29, 166304.59, 100243.92, 486019.71, 520294.14, 103799.55, 358085.84, 300072.88, 506384.07, 248562.13, 558519.24, 358884.02, 735781.11, 190212.07, 337355.92, 218052.25, 708994.25, 702654.25, 244623.81, 592495.09, 592805.37, 539807.57, 430506.24, 166711.54, 144249.59, 646568.05, 724814.37, 469712.28, 281535.94, 216239.43, 542404.77, 559355.46, 594588.2, 639436.73, 547661.37, 153067.35, 135750.57, 679138.51, 484159.49, 23289.78, 218663.21, 566731.81, 67368.36, 184889.73, 455814.45, 439942.52, 502714.98, 192282.57, 505639.97, 221088.12, 384529.12, 610923.84, 484943.26, 676854.94, 588856.47, 504839.99, 141211.99, 290861.33, 288922.76, 259367.28, 776541.79, 372099.55, 729609.06, 474256.81, 677367.33, 424160.02, 568173.17, 372990.05, 293587.21, 572550.72, 231950.44, 67218.99, 494676.43, 215758.01, 735951.32, 690216.79, 691315.73, 431970.64, 171810.37, 723431.21, 365924.47, 733493.57, 756119.38, 599641.75, 260884.18, 251511.76, 669478.41, 321282.15, 165248.28, 529540.19, 645616.19, 471601.37, 471013.88, 192949.05, 574326.26, 720342.14, 223490.75, 422947.09, 658595.46, 619201.81, 578101.77, 470357.15, 391483.54, 342179.06, 590040.64, 641616.72, 684975.32, 704471.06, 392640.86, 379942.33, 612571.54, 572362.1, 576007.65, 593629.34, 714338.54, 160719.6, 385956.78, 51452.12, 447217.05, 43277.54, 324544.59, 499326.47, 245030.29, 491137.64, 93241.64, 124062.07, 634096.47, 253979.07, 210579.19, 402826.37, 516916.55, 199273.44, 570489.06, 175120.63, 92452.56, 416201.49, 423846.95, 609102.58, 584208.42, 755202.24, 475016.91, 304935.08, 598798.57, 247994.28, 367725.65, 126096.95, 128493.23, 727384.97, 675918.59, 540746.76, 354975.0, 92063.63, 226411.39, 261238.38, 495628.5, 412539.48, 625051.96, 256975.9, 774943.21, 521085.12, 479827.68, 435240.73, 327041.59, 337919.99, 305747.44, 597417.77, 128218.99, 178133.13, 113572.73, 120739.99, 772606.67, 547088.12, 405122.29, 193570.78, 462117.01, 453944.96, 223847.77, 310699.62, 425662.27, 433381.55, 518819.99, 67866.41, 324656.6, 513893.56, 430684.84, 674226.68, 600303.76, 207657.45, 110426.07, 556837.37, 152368.66, 409018.13, 739525.42, 498503.71, 322136.53, 578004.89, 376817.92, 449570.16, 701835.15, 336398.23, 668989.88, 614109.14, 286884.27, 79470.81, 93455.53, 0.0, 106800.91, 469875.08, 205153.1, 340799.4, 610883.32, 203330.35, 673854.5, 249010.4, 29790.97, 659844.72, 430057.8, 585023.67, 622301.48, 739337.25, 334586.98, 222967.15, 611402.67, 662284.23, 781537.4, 367576.5, 331322.26, 595949.09, 267344.16, 689227.44, 569780.77, 359653.99, 532408.42, 529136.97, 153603.32, 753823.33, 461961.18, 554333.76, 241552.07, 726516.74, 288586.76, 71083.76, 713635.44, 88201.28, 295805.48, 649590.55, 686591.44, 478059.67, 421840.43, 399724.46, 271935.38, 324473.07, 540145.66, 651059.83, 615577.08, 586521.97, 142678.99, 435898.61, 116295.17, 447961.58, 337933.5, 641055.28, 241737.37, 241499.07, 109326.22, 554374.42, 456376.83, 188004.03, 117024.61, 610541.27, 90440.5, 643705.25, 509946.15, 237167.88, 72885.54, 756472.75, 359321.63, 345873.4, 614375.32, 707901.75, 742741.29, 576180.17, 377169.18, 241889.13, 571699.58, 383432.72, 356935.75, 815774.68, 109874.57, 489477.79, 166548.75, 363666.52, 141453.87, 236621.92, 135373.83, 503037.94, 549496.25, 418036.08, 692002.59, 266840.63, 269559.83, 622805.75, 237616.49, 647380.43, 99748.28, 771344.66, 4446.16, 695224.43, 492581.7, 684769.19, 208441.3, 469802.59, 694028.62, 425302.59, 527760.43, 548430.63, 408753.02, 452568.02, 477880.2, 612595.93, 100115.0, 219454.77, 679751.25, 737732.71, 437133.81, 524046.41, 207616.66, 186161.36, 448651.31, 320598.6, 584934.35, 147136.77, 742318.95, 725236.43, 552936.2, 429241.56, 319336.57, 672146.75, 497894.07, 118204.79, 598065.58, 655612.21, 660946.61, 457216.14, 508484.19, 481964.03, 704288.18, 701517.66, 109614.07, 87853.23, 375066.6, 607609.77, 754781.0, 192616.29, 442633.71, 381703.45, 720944.23, 605643.02, 667697.37, 346444.48, 356412.22, 259093.82, 167348.24, 682422.52, 622456.83, 790697.74, 817240.24, 477806.92, 594584.14, 647125.06, 595256.31, 226698.73, 348641.68, 152834.04, 721816.94, 510652.52, 225808.95, 552723.04, 495460.28, 217986.51, 104684.61, 521107.53, 365722.96, 626311.35, 502647.9, 711160.61, 436864.97, 528169.44, 674174.55, 330496.64, 134790.15, 79304.82, 565308.81, 502229.76, 558282.54, 218903.11, 188897.65, 144349.96, 359124.31, 398949.54, 212068.67, 417011.57, 616963.18, 298834.17, 363437.25, 513866.76, 369739.51, 532866.28, 628269.98, 586374.31, 146962.38, 720036.85, 333232.92, 258482.96, 384151.14, 765486.56, 413496.23, 248253.89, 562374.15, 229171.81, 124842.52, 115330.41, 139266.83, 133294.18, 160061.04, 593175.88, 129174.0, 227647.35, 753890.69, 384457.92, 492147.84, 243311.15, 174514.31, 193886.8, 222927.46, 238652.91, 302347.49, 104588.46, 193533.98, 400990.3, 279362.32, 398957.72, 416406.87, 503345.62, 124534.3, 580716.25, 599502.13, 137014.11, 646399.49, 705822.89, 48871.31, 213311.71, 679206.56, 547230.58, 147206.14, 243143.43, 384353.88, 438000.68, 542124.36, 286176.95, 316120.4, 654609.57, 83627.17, 232853.29, 622920.68, 707076.12, 443176.66, 542426.72, 115165.2, 423395.35, 437367.31, 252097.2, 333162.6, 355058.6, 115462.86, 346028.8, 199479.77, 254100.23, 103598.98, 577788.09, 578485.26, 478233.65, 596627.9, 397607.82, 149041.53, 478333.78, 514141.43, 549017.77, 358014.11, 175245.7, 254114.18, 400447.83, 535542.89, 497019.24, 348509.35, 799571.49, 492949.08, 170286.49, 163687.57, 145612.07, 214590.63, 212778.13, 262846.89, 268502.82, 207468.83, 765427.41, 141195.44, 559129.34, 380293.34, 650067.43, 188293.34, 362610.45, 793880.18, 692876.38, 619600.85, 187869.5, 179897.96, 483808.15, 673302.62, 480243.87, 544333.79, 283719.46, 534613.58, 223484.66, 353315.06, 331680.45, 410936.15, 239360.98, 113269.94, 519582.55, 263778.22, 488312.42, 134820.22, 377896.65, 470616.93, 91339.23, 388556.08, 145748.1, 129012.34, 789852.7, 221670.56, 533624.81, 170599.63, 598143.54, 560560.9, 604966.11, 365101.55, 362220.18, 387591.58, 802736.82, 738743.28, 786811.48, 210103.75, 597961.89, 747297.86, 169773.03, 78975.04, 575087.72, 454260.12, 620573.02, 204165.73, 659570.7, 215518.79, 259344.27, 128794.96, 615154.96, 488167.01, 334742.33, 313076.54, 661022.99, 415572.93, 657745.21, 320206.72, 422142.12, 448360.54, 307534.95, 568312.13, 366364.3, 213133.23, 736650.27, 428355.89, 519060.36, 662426.2, 440379.78, 160950.49, 620964.72, 514861.32, 293681.16, 145706.82, 531231.85, 519229.12, 408451.2, 619881.65, 463690.01, 176004.8, 374024.98, 325793.13, 554308.93, 67523.79, 483114.25, 539740.34, 681906.4, 344209.19, 690695.34, 144668.72, 636171.61, 117155.72, 301824.9, 601850.43, 194562.54, 275423.92, 522361.54, 635659.09, 494218.47, 542346.84, 403978.42, 123752.35, 352547.07, 234420.65, 674137.75, 472139.0, 371371.67, 308726.62, 687963.62, 218225.43, 407990.67, 431152.75, 419902.52, 110545.87, 661901.56, 623423.25, 514701.87, 508509.73, 657174.46, 562414.54, 235395.72, 413203.55, 487616.65, 382729.03, 606755.14, 714519.81, 681407.35, 337937.06, 155742.88, 686160.86, 495188.68, 180975.3, 741765.01, 544033.42, 374729.15, 505068.63, 447201.6, 113003.79, 264857.99, 607781.26, 146870.44, 267813.73, 303804.27, 413604.86, 648236.11, 314917.06, 390427.33, 588967.31, 367629.43, 212017.69, 302237.13, 214233.98, 190169.36, 402374.25, 517430.06, 707458.63, 282026.33, 445579.26, 559200.68, 89502.28, 450973.83, 241135.72, 690315.26, 269012.23, 408873.69, 110244.93, 811940.94, 417374.41, 519523.57, 144513.26, 538905.48, 184508.78, 732684.69, 196730.49, 183531.79, 51914.9, 414825.14, 559394.01, 65976.69, 599692.11, 451580.99, 424981.36, 395133.44, 292395.39, 474172.58, 170429.95, 247087.99, 716074.6, 843106.12, 355965.45, 274042.47, 519418.91, 333237.25, 109059.98, 165632.93, 566704.3, 585653.54, 42962.67, 281825.14, 296831.24, 522624.18, 0.0, 114882.19, 679793.08, 194374.24, 465638.51, 210534.63, 184153.94, 266477.91, 550583.57, 634253.9, 615810.5, 296978.37, 606726.25, 197248.38, 333732.64, 756092.48, 133691.84, 111137.24, 235509.73, 91699.46, 152283.83, 484771.02, 300509.58, 736937.37, 603543.54, 315784.7, 264275.21, 318347.13, 502783.78, 232197.77, 539865.38, 284053.88, 453950.83, 466331.86, 223747.82, 681318.73, 616129.3, 178555.48, 678747.39, 428475.42, 710558.83, 670387.29, 382510.05, 78103.9, 289985.9, 535597.19, 495966.11, 200347.72, 224419.38, 632558.85, 630837.99, 472211.96, 164117.11, 254280.78, 104012.72, 701676.68, 189954.57, 442374.3, 285642.56, 436092.82, 551649.29, 665844.09, 167562.42, 136721.29, 140599.63, 722915.47, 683240.17, 570163.03, 469175.58, 506433.92, 192404.63, 677069.07, 397667.2, 252802.98, 372585.33, 53311.88, 234756.65, 658703.36, 125666.64, 473686.59, 244113.26, 395868.45, 223500.62, 326997.53, 609115.87, 300611.87, 466802.21, 446386.33, 387816.42, 741253.84, 536782.38, 128553.11, 121608.75, 320711.16, 469805.18, 157356.15, 490661.13, 543614.65, 382612.85, 632472.11, 150725.5, 45619.71, 554224.29, 367294.31, 648218.75, 359714.16, 247481.61, 655468.33, 616785.84, 628672.67, 227565.5, 483136.07, 281533.85, 70816.77, 663598.21, 165500.74, 694945.1, 341432.85])


# Normalize x_train
x_min = np.min(x_train_us)
x_max = np.max(x_train_us)
x_train_norm = (x_train_us - x_min) / (x_max - x_min)

# Normalize y_train
y_min = np.min(y_train_us)
y_max = np.max(y_train_us)
y_train_norm = (y_train_us - y_min) / (y_max - y_min)

x_train_norm, x_test_norm, y_train_norm, y_test_norm = train_test_split(
    x_train_norm, y_train_norm, test_size=0.2, random_state=42
)

m = len(x_train_norm)  # Number of training examples

# Model function
def F(w, b, x):
    return w * x + b

# Cost function
def J(w, b, x, y):
    m = len(x)
    cost = 0
    for i in range(m):
        cost += (F(w, b, x[i]) - y[i]) ** 2
    cost = (1 / (2 * m)) * cost
    return cost

# Compute gradient
def compute_gradient(w, b, x, y):
    m = len(x)
    dj_dw = 0
    dj_db = 0
    for i in range(m):
        error = F(w, b, x[i]) - y[i]
        dj_dw += error * x[i]
        dj_db += error
    dj_dw = (1 / m) * dj_dw
    dj_db = (1 / m) * dj_db
    return dj_dw, dj_db

# Gradient descent algorithm
def gradient_descent(w, b, x, y, alpha, tolerance=1e-6, max_iters=10000):
    previous_cost = float('inf')
    for i in range(max_iters):
        dj_dw, dj_db = compute_gradient(w, b, x, y)
        w -= alpha * dj_dw
        b -= alpha * dj_db
        cost = J(w, b, x, y)
        if i % 100 == 0:
            print(f"Iteration {i}: Cost {cost}, w: {w}, b: {b}")
        # Early stopping condition
        if abs(previous_cost - cost) < tolerance:
            print(f"Converged at iteration {i}")
            break
        previous_cost = cost
    return w, b

# Initialize parameters
initial_w = 0
initial_b = 0
learning_rate = 0.01  # Adjusted learning rate

# Train the model using gradient descent
final_w, final_b = gradient_descent(initial_w, initial_b, x_train_norm, y_train_norm, learning_rate)

print(f"\nFinal parameters: w = {final_w}, b = {final_b}")
final_cost = J(final_w, final_b, x_train_norm, y_train_norm)
print(f"Final cost on training data: {final_cost}")

# Prediction function
def predict(w, b, x):
    return w * x + b

# Make predictions on the test set
y_pred_norm = predict(final_w, final_b, x_test_norm)

# Denormalize predictions to original scale
y_pred_us = y_pred_norm * (y_max - y_min) + y_min
y_test_us = y_test_norm * (y_max - y_min) + y_min

# Calculate accuracy metrics
def mean_squared_error(y_true, y_pred):
    return np.mean((y_true - y_pred) ** 2)

def r2_score(y_true, y_pred):
    ss_total = np.sum((y_true - np.mean(y_true)) ** 2)
    ss_residual = np.sum((y_true - y_pred) ** 2)
    return 1 - (ss_residual / ss_total)

mse = mean_squared_error(y_test_us, y_pred_us)
r2 = r2_score(y_test_us, y_pred_us)

print(f"\nModel performance on test data:")
print(f"Mean Squared Error (MSE): {mse}")
print(f"RÂ² Score: {r2}")

# Optionally, plot the regression line and test data
# plt.figure(figsize=(8, 6))
# plt.scatter(x_test_us, y_test_us, color='blue', label='Actual Data')
# plt.plot(x_test_us, y_pred_us, color='red', label='Predicted Regression Line')
# plt.xlabel('Square Footage (sq ft)')
# plt.ylabel('Price ($)')
# plt.title('Linear Regression Model')
# plt.legend()
# plt.show()